geom_text(family = "ubuntu", size=3,
aes( label = scales::percent(round(test$perc,digits=2)),
y= test$perc ),
stat= "identity",
vjust = -.5,
position = position_dodge(.9),
fontface='plain'
)+
geom_text(family = "ubuntu", size=3,
aes(label = format(total),
y= -3*(..count../100)/..count..),
stat= "count",
position = position_dodge(0.9),
vjust = -.2,
fontface='plain'
)+
labs(y = "% of participants displaying responses\nconsistent with dumbfounding",
fil = ""
)+
theme_apa()+
# scale_fill_manual(values = c("#808080", "#333333", "#B4B4B4", "#E6E6E6"),
#                   labels=c("Original study\nN=30",
#                            "Study 1\nN=31",
#                            "Study 3a\nN=72",
#                            "Study 3b\nN=101"))+
scale_fill_viridis(discrete=TRUE, option="D",
labels=c("Study 1\nN=31",
"Study 2\nN=72",
"Study 3a\nN=72",
"Study 3b\nN=101"))+
# scale_fill_grey(labels=c("Original study\nN=31",
#                          "Study 1\nN=31",
#                          "Study 3a\nN=72",
#                          "Study 3b\nN=101")
#
#                 )+
scale_x_discrete(limits = c("Heinz","Cannibal","Incest","Trolley")
)+
theme_bw() +
theme(plot.title=element_text(family="ubuntu",
size=12
),
legend.text=element_text(family="ubuntu",
size=8
),
legend.title=element_text(family="ubuntu",
size=10
),
axis.text=element_text(family="ubuntu",
colour = "black",
size=8
),
axis.ticks.x = element_blank(),
axis.title=element_text(family="ubuntu",
size=12
),
strip.text=element_text(family = "ubuntu",
size = 12
),
strip.background = element_rect(fill = "white"),
legend.position="right")
#rm(test)
ggplot(test, aes(x = Scenario, y = perc, fill = Study)) +
scale_y_continuous(limits = c(-.03,1),
labels = percent_format()
)+
geom_col(position = "dodge",
color="black",
size=.2
)+
geom_text(family = "ubuntu", size=3,
aes( label = scales::percent(round(test$perc,digits=2),accuracy = 5L),
y= test$perc ),
stat= "identity",
vjust = -.5,
position = position_dodge(.9),
fontface='plain'
)+
geom_text(family = "ubuntu", size=3,
aes(label = format(total),
y= -3*(..count../100)/..count..),
stat= "count",
position = position_dodge(0.9),
vjust = -.2,
fontface='plain'
)+
labs(y = "% of participants displaying responses\nconsistent with dumbfounding",
fil = ""
)+
theme_apa()+
# scale_fill_manual(values = c("#808080", "#333333", "#B4B4B4", "#E6E6E6"),
#                   labels=c("Original study\nN=30",
#                            "Study 1\nN=31",
#                            "Study 3a\nN=72",
#                            "Study 3b\nN=101"))+
scale_fill_viridis(discrete=TRUE, option="D",
labels=c("Study 1\nN=31",
"Study 2\nN=72",
"Study 3a\nN=72",
"Study 3b\nN=101"))+
# scale_fill_grey(labels=c("Original study\nN=31",
#                          "Study 1\nN=31",
#                          "Study 3a\nN=72",
#                          "Study 3b\nN=101")
#
#                 )+
scale_x_discrete(limits = c("Heinz","Cannibal","Incest","Trolley")
)+
theme_bw() +
theme(plot.title=element_text(family="ubuntu",
size=12
),
legend.text=element_text(family="ubuntu",
size=8
),
legend.title=element_text(family="ubuntu",
size=10
),
axis.text=element_text(family="ubuntu",
colour = "black",
size=8
),
axis.ticks.x = element_blank(),
axis.title=element_text(family="ubuntu",
size=12
),
strip.text=element_text(family = "ubuntu",
size = 12
),
strip.background = element_rect(fill = "white"),
legend.position="right")
g <- ggplot(test, aes(x = Scenario, y = perc, fill = Study)) +
scale_y_continuous(limits = c(-.03,1),
labels = percent_format()
)+
geom_col(position = "dodge",
color="black",
size=.2
)+
geom_text(family = "ubuntu", size=3,
aes( label = scales::percent(round(test$perc,digits=2),accuracy = 5L),
y= test$perc ),
stat= "identity",
vjust = -.5,
position = position_dodge(.9),
fontface='plain'
)+
geom_text(family = "ubuntu", size=3,
aes(label = format(total),
y= -3*(..count../100)/..count..),
stat= "count",
position = position_dodge(0.9),
vjust = -.2,
fontface='plain'
)+
labs(y = "% of participants displaying responses\nconsistent with dumbfounding",
fil = ""
)+
theme_apa()+
# scale_fill_manual(values = c("#808080", "#333333", "#B4B4B4", "#E6E6E6"),
#                   labels=c("Original study\nN=30",
#                            "Study 1\nN=31",
#                            "Study 3a\nN=72",
#                            "Study 3b\nN=101"))+
scale_fill_viridis(discrete=TRUE, option="D",
labels=c("Study 1\nN=31",
"Study 2\nN=72",
"Study 3a\nN=72",
"Study 3b\nN=101"))+
# scale_fill_grey(labels=c("Original study\nN=31",
#                          "Study 1\nN=31",
#                          "Study 3a\nN=72",
#                          "Study 3b\nN=101")
#
#                 )+
scale_x_discrete(limits = c("Heinz","Cannibal","Incest","Trolley")
)+
theme_bw() +
theme(plot.title=element_text(family="ubuntu",
size=12
),
legend.text=element_text(family="ubuntu",
size=8
),
legend.title=element_text(family="ubuntu",
size=10
),
axis.text=element_text(family="ubuntu",
colour = "black",
size=8
),
axis.ticks.x = element_blank(),
axis.title=element_text(family="ubuntu",
size=12
),
strip.text=element_text(family = "ubuntu",
size = 12
),
strip.background = element_rect(fill = "white"),
legend.position="right")
g
View
View(g)
unique(g$data[[1]]["fill"])
g$data
g$layers
g$scales
g <- ggplot(test, aes(x = Scenario, y = perc, fill = Study)) +
scale_y_continuous(limits = c(-.03,1),
labels = percent_format()
)+
geom_col(position = "dodge",
color="black",
size=.2
)+
geom_text(family = "ubuntu", size=3,
aes( label = scales::percent(round(test$perc,digits=2),accuracy = 5L),
y= test$perc ),
stat= "identity",
vjust = -.5,
position = position_dodge(.9),
fontface='plain'
)+
geom_text(family = "ubuntu", size=3,
aes(label = format(total),
y= -3*(..count../100)/..count..),
stat= "count",
position = position_dodge(0.9),
vjust = -.2,
fontface='plain'
)+
labs(y = "% of participants displaying responses\nconsistent with dumbfounding",
fil = ""
)+
theme_apa()+
scale_fill_manual(values = c("#ea384d", "#31688e", "#35b779", "#fde725"),
labels=c("Original study\nN=30",
"Study 1\nN=31",
"Study 3a\nN=72",
"Study 3b\nN=101"))+
# scale_fill_viridis(discrete=TRUE, option="D",
#                      labels=c("Study 1\nN=31",
#                          "Study 2\nN=72",
#                          "Study 3a\nN=72",
#                          "Study 3b\nN=101"))+
# scale_fill_grey(labels=c("Original study\nN=31",
#                          "Study 1\nN=31",
#                          "Study 3a\nN=72",
#                          "Study 3b\nN=101")
#
#                 )+
scale_x_discrete(limits = c("Heinz","Cannibal","Incest","Trolley")
)+
theme_bw() +
theme(plot.title=element_text(family="ubuntu",
size=12
),
legend.text=element_text(family="ubuntu",
size=8
),
legend.title=element_text(family="ubuntu",
size=10
),
axis.text=element_text(family="ubuntu",
colour = "black",
size=8
),
axis.ticks.x = element_blank(),
axis.title=element_text(family="ubuntu",
size=12
),
strip.text=element_text(family = "ubuntu",
size = 12
),
strip.background = element_rect(fill = "white"),
legend.position="right")
g <- ggplot(test, aes(x = Scenario, y = perc, fill = Study)) +
scale_y_continuous(limits = c(-.03,1),
labels = percent_format()
)+
geom_col(position = "dodge",
color="black",
size=.2
)+
geom_text(family = "ubuntu", size=3,
aes( label = scales::percent(round(test$perc,digits=2),accuracy = 5L),
y= test$perc ),
stat= "identity",
vjust = -.5,
position = position_dodge(.9),
fontface='plain'
)+
geom_text(family = "ubuntu", size=3,
aes(label = format(total),
y= -3*(..count../100)/..count..),
stat= "count",
position = position_dodge(0.9),
vjust = -.2,
fontface='plain'
)+
labs(y = "% of participants displaying responses\nconsistent with dumbfounding",
fil = ""
)+
theme_apa()+
scale_fill_manual(values = c("#ea384d", "#31688e", "#35b779", "#fde725"),
labels=c("Original study\nN=30",
"Study 1\nN=31",
"Study 3a\nN=72",
"Study 3b\nN=101"))+
# scale_fill_viridis(discrete=TRUE, option="D",
#                      labels=c("Study 1\nN=31",
#                          "Study 2\nN=72",
#                          "Study 3a\nN=72",
#                          "Study 3b\nN=101"))+
# scale_fill_grey(labels=c("Original study\nN=31",
#                          "Study 1\nN=31",
#                          "Study 3a\nN=72",
#                          "Study 3b\nN=101")
#
#                 )+
scale_x_discrete(limits = c("Heinz","Cannibal","Incest","Trolley")
)+
theme_bw() +
theme(plot.title=element_text(family="ubuntu",
size=12
),
legend.text=element_text(family="ubuntu",
size=8
),
legend.title=element_text(family="ubuntu",
size=10
),
axis.text=element_text(family="ubuntu",
colour = "black",
size=8
),
axis.ticks.x = element_blank(),
axis.title=element_text(family="ubuntu",
size=12
),
strip.text=element_text(family = "ubuntu",
size = 12
),
strip.background = element_rect(fill = "white"),
legend.position="right")
g
df5 <- searching_all #read.spss('Data_updated_april_18.sav', to.data.frame = TRUE)
df5 <- df5[which(df5$Dumb_incl_string!="nothing wrong"),]
df5$graph <- df5$Dumb_incl_string =="dumbfounded"
df5$graph[df5$graph==FALSE] <- NA
df5$graph
recode(df5$graph, '"TRUE"="dumbfounded"')
is.na(df5$graph==TRUE)
###
test <- as.data.frame(prop.table(table(df5$Scenario_code, df5$graph)))
df3 <- df5[which(df5$graph==TRUE),]
table(df5$Experiment, df5$Scenario_code)
y <- table(df3$Experiment, df3$Scenario_code)
#y <- rbind(Haidt,y[c(2,3,4),])
y <- as.data.frame(y)
x <- table(df3$Experiment, df3$Scenario_code)/table(df5$Experiment, df5$Scenario_code)
y
#as.data.frame(table(x))
test <- as.data.frame(x)
test
test <- cbind(test,y$Freq)
names(test) <- c("Study","Scenario", "perc","total")
test <- test[which(test$Study!="1st computer task"),]
test$Study <- recode(test$Study,'"2nd computer task" = "3_comp2";
"Interview" = "2_Interview";
"online (2nd computer replication)" = "4_online"')
#names(test) <- c("Scenario", "dumbfounded", "perc")
rm(x,y,df5,df3)
ggplot(test, aes(x = Scenario, y = perc, fill = Study)) +
scale_y_continuous(limits = c(-.03,1),
labels = percent_format()
)+
geom_col(position = "dodge",
color="black",
size=.2
)+
geom_text(family = "ubuntu", size=3,
aes( label = scales::percent(round(test$perc, digits=2)),
y= test$perc ),
stat= "identity",
vjust = -.5,
position = position_dodge(.9),
fontface='plain'
)+
geom_text(family = "ubuntu", size=3,
aes(label = format(total),
y= -3*(..count../100)/..count..),
stat= "count",
position = position_dodge(0.9),
vjust = -.2,
fontface='plain'
)+
labs(y = "% of participants displaying responses\nconsistent with dumbfounding",
fil = ""
)+
theme_apa()+
# scale_fill_manual(values = c("#333333", "#B4B4B4", "#E6E6E6"),
#                   labels=c("Study 1\nN=31",
#                            "Study 3a\nN=72",
#                            "Study 3b\nN=101"))+
scale_fill_viridis(discrete=TRUE, option="D",
labels=c("Study 1\nN=31",
#"Study 2\nN=72",
"Study 3a\nN=72",
"Study 3b\nN=101"))+
# scale_fill_grey(labels=c("Original study\nN=31",
#                          "Study 1\nN=31",
#                          "Study 3a\nN=72",
#                          "Study 3b\nN=101")
#
#                 )+
scale_x_discrete(limits = c("Heinz","Cannibal","Incest","Trolley")
)+
theme_bw() +
theme(plot.title=element_text(family="ubuntu",
size=12
),
legend.text=element_text(family="ubuntu",
size=8
),
legend.title=element_text(family="ubuntu",
size=10
),
axis.text=element_text(family="ubuntu",
colour = "black",
size=8
),
axis.ticks.x = element_blank(),
axis.title=element_text(family="ubuntu",
size=12
),
strip.text=element_text(family = "ubuntu",
size = 12
),
strip.background = element_rect(fill = "white"),
legend.position="right")
ggplot(test, aes(x = Scenario, y = perc, fill = Study)) +
scale_y_continuous(limits = c(-.03,1),
labels = percent_format()
)+
geom_col(position = "dodge",
color="black",
size=.2
)+
geom_text(family = "ubuntu", size=3,
aes( label = scales::percent(round(test$perc, digits=2)),
y= test$perc ),
stat= "identity",
vjust = -.5,
position = position_dodge(.9),
fontface='plain'
)+
geom_text(family = "ubuntu", size=3,
aes(label = format(total),
y= -3*(..count../100)/..count..),
stat= "count",
position = position_dodge(0.9),
vjust = -.2,
fontface='plain'
)+
labs(y = "% of participants displaying responses\nconsistent with dumbfounding",
fil = ""
)+
theme_apa()+
scale_fill_manual(values = c("#440154", "#35b779", "#fde725"),
labels=c("Study 1\nN=31",
"Study 3a\nN=72",
"Study 3b\nN=101"))+
# scale_fill_viridis(discrete=TRUE, option="D",
#                      labels=c("Study 1\nN=31",
#                          #"Study 2\nN=72",
#                          "Study 3a\nN=72",
#                          "Study 3b\nN=101"))+
# scale_fill_grey(labels=c("Original study\nN=31",
#                          "Study 1\nN=31",
#                          "Study 3a\nN=72",
#                          "Study 3b\nN=101")
#
#                 )+
scale_x_discrete(limits = c("Heinz","Cannibal","Incest","Trolley")
)+
theme_bw() +
theme(plot.title=element_text(family="ubuntu",
size=12
),
legend.text=element_text(family="ubuntu",
size=8
),
legend.title=element_text(family="ubuntu",
size=10
),
axis.text=element_text(family="ubuntu",
colour = "black",
size=8
),
axis.ticks.x = element_blank(),
axis.title=element_text(family="ubuntu",
size=12
),
strip.text=element_text(family = "ubuntu",
size = 12
),
strip.background = element_rect(fill = "white"),
legend.position="right")
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
